<div class="card p-4">
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
        <!-- Section 1: Personal Info -->
        <h2 class="text-xl font-semibold mb-3">Employee Details</h2>
        <div class="grid grid-cols-3 gap-4">
            <div>
                <label for="email">Email</label>
                <input pInputText id="email" formControlName="email" class="w-full" />
                <small class="text-red-500" *ngIf="userForm.get('email')?.touched && userForm.get('email')?.hasError('required')"> Email is required </small>
                <small class="text-red-500" *ngIf="userForm.get('email')?.touched && userForm.get('email')?.hasError('email')"> Invalid email format </small>
            </div>
            <div>
                <label for="firstName">First Name</label>
                <input pInputText id="firstName" formControlName="firstName" class="w-full" />
                <small class="text-red-500" *ngIf="userForm.get('firstName')?.touched && userForm.get('firstName')?.hasError('required')"> First Name is required </small>
            </div>
            <div>
                <label for="lastName">Last Name</label>
                <input pInputText id="lastName" formControlName="lastName" class="w-full" />
                <small class="text-red-500" *ngIf="userForm.get('lastName')?.touched && userForm.get('lastName')?.hasError('required')"> Last Name is required </small>
            </div>
            <div>
                <label for="gender">Gender</label>
                <p-dropdown id="gender" formControlName="gender" [options]="genderOptions" optionLabel="label" optionValue="value" placeholder="Select Gender" class="w-full"> </p-dropdown>
                <small class="text-red-500" *ngIf="userForm.get('gender')?.touched && userForm.get('gender')?.hasError('required')"> Gender is required </small>
            </div>
            <div>
                <label for="departmentID">Department</label>
                <p-dropdown id="departmentID" formControlName="departmentID" [options]="departments" optionLabel="departmentName" optionValue="id" placeholder="Select Department" class="w-full"> </p-dropdown>
                <small class="text-red-500" *ngIf="userForm.get('departmentID')?.touched && userForm.get('departmentID')?.hasError('required')"> Department Name is required </small>
            </div>
            <div>
                <label for="designationID">Designation</label>
                <p-dropdown id="designationID" formControlName="designationID" [options]="designations" optionLabel="designationName" optionValue="id" placeholder="Select Designation" class="w-full"> </p-dropdown>
                <small class="text-red-500" *ngIf="userForm.get('designationID')?.touched && userForm.get('designationID')?.hasError('required')"> Designation Name is required </small>
            </div>
        </div>

        <div class="grid grid-cols-3 gap-4 mt-5">
            <div>
                <label for="nidNumber">NID Number</label>
                <input pInputText id="nidNumber" formControlName="nidNumber" type="text" class="w-full" maxlength="12" />

                <small class="text-red-500" *ngIf="userForm.get('nidNumber')?.touched && userForm.get('nidNumber')?.hasError('required')"> Nid Number is required </small>

                <small class="text-red-500" *ngIf="userForm.get('nidNumber')?.touched && userForm.get('nidNumber')?.hasError('maxlength')"> NID Number cannot be greater than 12 digits </small>

                <small class="text-red-500" *ngIf="userForm.get('nidNumber')?.touched && userForm.get('nidNumber')?.hasError('pattern')"> Only numbers are allowed </small>
            </div>

            <div>
                <label for="birthDate">Birth Date</label> <br />
                <p-datepicker [style]="{ width: '40rem' }" id="birthDate" formControlName="birthDate" dateFormat="yy-mm-dd" class="w-full" showIcon="true"></p-datepicker>
                <small class="text-red-500" *ngIf="userForm.get('birthDate')?.touched && userForm.get('birthDate')?.hasError('required')"> Birth Date is required </small>
            </div>
            <div>
                <label for="joinDate">Join Date</label> <br />
                <p-datepicker id="joinDate" [style]="{ width: '40rem' }" formControlName="joinDate" dateFormat="yy-mm-dd" class="w-full" showIcon="true"></p-datepicker>
                <small class="text-red-500" *ngIf="userForm.get('joinDate')?.touched && userForm.get('joinDate')?.hasError('required')"> Join Date is required </small>
            </div>
        </div>

        <hr class="my-4" />

        <h2 class="text-xl font-semibold mb-3">Security</h2>
        <div class="grid grid-cols-3 gap-4">
            <div *ngIf="isUpdate">
                <label for="password">Password</label>
                <input type="password" pInputText id="password" formControlName="password" class="w-full" />
                <small class="text-red-500" *ngIf="!employeeId && userForm.get('password')?.touched && userForm.get('password')?.hasError('required')">Password is required </small>
            </div>
            <div *ngIf="isUpdate">
                <label for="cPassword">Confirm Password</label>
                <input type="password" pInputText id="cPassword" formControlName="cPassword" class="w-full" />
                <small class="text-red-500" *ngIf="!employeeId && userForm.get('cPassword')?.touched && userForm.get('cPassword')?.hasError('required')">Password is required </small>
                <small class="text-red-500" *ngIf="!employeeId && userForm.get('cPassword')?.touched && userForm.get('cPassword')?.hasError('mustMatch')"> Passwords do not match </small>
            </div>
            <div class="mt-5">
                <p-checkbox formControlName="isActive" binary="true" inputId="isActive"></p-checkbox>
                <label for="isActive" class="ml-2">Active</label>

                <p-checkbox class="ml-5" formControlName="isAdmin" binary="true" inputId="isAdmin"></p-checkbox>
                <label for="isAdmin" class="ml-2">Admin</label>
            </div>
        </div>

        <hr class="my-4" />

        <!-- Section 3: Address Info -->
        <h2 class="text-xl font-semibold mb-3">Address Information</h2>
        <div class="grid grid-cols-3 gap-4 mt-5">
            <div>
                <label for="presentAddress">Present Address</label>
                <textarea style="border: 1px solid grey; border-radius: 5px" pInputTextarea id="presentAddress" formControlName="presentAddress" rows="3" class="w-full"></textarea>
            </div>
            <div>
                <label for="permanentAddress">Permanent Address</label>
                <textarea style="border: 1px solid grey; border-radius: 5px" pInputTextarea id="permanentAddress" formControlName="permanentAddress" rows="3" class="w-full"></textarea>
            </div>
            <div>
                <label for="about">About</label>
                <textarea style="border: 1px solid grey; border-radius: 5px" pInputTextarea id="about" formControlName="about" rows="3" class="w-full"></textarea>
            </div>
        </div>

        <hr class="my-4" />

        <!-- Section 4: Uploads -->
        <h2 class="text-xl font-semibold mb-3">Uploads</h2>
        <div class="grid grid-cols-3 gap-4">
            <div>
                <label>Profile Image</label> <br />
                <input class="fileSelectInput" type="file" (change)="onFileSelected($event, 'image')" />
                <div *ngIf="preview.image" class="mt-2">
                    <img [src]="preview.image" alt="Profile Preview" class="rounded border shadow" style="width: 12rem; height: 13rem; padding: 2px" />
                </div>
            </div>
            <div>
                <label>Signature</label> <br />
                <input type="file" (change)="onFileSelected($event, 'signature')" />
                <div *ngIf="preview.image" class="mt-2">
                    <img [src]="preview.signature" alt="Profile Preview" class="rounded border shadow" style="width: 70rem; height: 12rem" />
                </div>
            </div>
        </div>

        <!-- Submit Button -->
        <div class="mt-5 flex justify-end">
            <button pButton type="submit" label="Save User" class="p-button-success"></button>
        </div>
    </form>
</div>
<app-loading [isLoading]="loading"></app-loading>
